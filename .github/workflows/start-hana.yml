name: Start HANA Instance via Puppeteer

on:
  schedule:
    - cron: '0 7 * * *'  
  workflow_dispatch:     

jobs:
  puppeteer:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v3

    - name: Setup Node.js
      uses: actions/setup-node@v3
      with:
        node-version: 20

    - name: Install Puppeteer dependencies
      run: |
        sudo apt-get update
        sudo apt-get install -y \
          libx11-xcb1 libxcomposite1 libxdamage1 libxrandr2 libgbm-dev \
          libgtk-3-0 libasound2t64 libnss3 libxshmfence-dev libxss1 fonts-liberation \
          libatk-bridge2.0-0 libcups2 libatk1.0-0 libdbus-1-3 libgdk-pixbuf2.0-0


    - name: Install project dependencies
      run: npm i

    - name: Run Puppeteer script
      env:
        HANA_USER: ${{ secrets.HANA_USER }}
        HANA_PASS: ${{ secrets.HANA_PASS }}
        HANA_INSTANCE_URL: ${{ secrets.HANA_INSTANCE_URL }}
      run: npm start
